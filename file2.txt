edited from staging 2 branch